---
- hosts: all
  become: true

  pre_tasks:
    - name: Ensure base packages are installed
      apt:
        name: '{{ item }}'
        state: present
        update_cache: yes
        cache_valid_time: 86400
      with_items:
        - curl
        - git
        - unzip
        - wget

  roles:
    - { role: kamaln7.swapfile, when: "'swapfile' in draft_features" }
    - { role: git_config, when: "'git_config' in draft_features" }
    - { role: apache2, when: "'apache2' in draft_features" }
    - { role: mysql, when: "'mysql' in draft_features" }
    - { role: T2L.php, when: "'php' in draft_features" }
    - { role: T2L.composer, when: "'composer' in draft_features" }
    - { role: T2L.java, when: "'java' in draft_features" }
    - { role: T2L.solr, when: "'solr' in draft_features" }
    - { role: project }
  vars_files:
    - vars/swapfile.yml
    - vars/php.yml
    - vars/solr.yml
    - vars/composer.yml
